@model Referee.Models.Nomination

@using Referee.ViewModels
@using Referee.Helpers
           
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
@Html.Partial("_ContentTop", ViewData)

@Html.Partial("_CustomBreadcrumbBar", ViewData)

@{
    List<Referee.ViewModels.Conflicts> Conflicts = (List<Referee.ViewModels.Conflicts>)ViewBag.Conflicts;
    int i = 0;
    string photoPath = "~/Content/themes/aquincum/images/userLogin2.png";
}
<div class="wrapper">
    <div class="fluid">
        <div class="grid9">        
            @using (Html.BeginForm())
            {
                @Html.ValidationSummary(true)
                var Event = (Event)ViewBag.Event;
                if (((Event)ViewBag.Event).Type == "game")
                {
                    @Html.Hidden("GameId", Event.Ident, new { id = "EventIdent" } )
                    @Html.Hidden("Type", "Game", new { id = "EventType" })
                }
                else
                {
                    @Html.Hidden("Type", "Tournamet", new { id = "EventType" })
                    @Html.Hidden("TournamentId", Event.Ident, new { id = "EventIdent" })
                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <fieldset>
        <div class="widget" id="refereeNominations">
            <div class="whead">
                <h6>Utwórz obsadę</h6>
                <div class="clear"></div>
            </div>
            <div class="formRow">
                <div class="grid3">
                    Obsada dla @((((Event)ViewBag.Event).Type == "game") ? "meczu" : "turnieju")
                </div>
                <div class="grid6">
                    <ul>
                        <li>
                            @(((Event)ViewBag.Event).Name)
                        </li>
                        <li>
                            @(((Event)ViewBag.Event).Venue)
                        </li>
                        <li>
                            @(((Event)ViewBag.Event).Date)
                        </li>
                        <li>
                            @(((Event)ViewBag.Event).Time)
                        </li>
                    </ul>
                </div>
                <div class="clear"></div>
            </div>
            
                
                @{ Html.RenderAction("CreateRefereeData"); }
                 
            <div class="formRow" id="NotePosition">
                <div class="grid9">
                    <a href="/Nomination/CreateRefereeData" id="addItem" class="buttonS bBlue">Dodaj sędziego</a>
                </div>
                <div class="clear"></div>
            </div>     
            <div class="formRow" >
                <div class="grid3">
                    @Html.LabelFor(model => model.Note)
                </div>
                <div class="grid6">
                    @Html.EditorFor(model => model.Note)
                    @Html.ValidationMessageFor(model => model.Note)
                </div>
                <div class="clear"></div>
            </div>
        

            <div class="formRow">
                <div class="grid3">
                    @Html.LabelFor(model => model.Published)
                </div>
                <div class="grid6">
                    @Html.EditorFor(model => model.Published)
                    @Html.ValidationMessageFor(model => model.Published)
                </div>
                <div class="clear"></div>
            </div>            

            <div class="formRow" id="submitFormRow">
                <input type="submit" value="Dodaj nominacje" class="buttonS bGreen" />
            </div>
        </div>
    </fieldset>
            }   
        </div>
        <div class="grid3">
            <div class="widget">
                <div class="whead"><h6>Zajęci sędziowie</h6><div class="clear"></div></div>
                    <ul class="messagesOne">                    
                        @foreach (var conflict in Conflicts)
                        {
                            i++;
                            <li class="@((i % 2 == 0 ) ? "by_user": "by_me")">
                                <a href="#" title=""><img src="@Url.Content(conflict.Photo)" alt="" /></a>
                                <div class="messageArea">
                                    <span class="aro"></span>
                                    <div class="infoRow">
                                        <span class="name"><strong>@conflict.Referee</strong> sędziuje:</span>
                                        <div class="clear"></div>
                                    </div>
                                    <strong>Co: </strong>@conflict.Event <br />
                                    <strong>Kiedy: </strong>@conflict.Period <br />
                                    <div class="bottom">
                                        @Html.AuthLink("Nominacja", "Edit", "Nomination", new { @Id = conflict.NominationId }, new { }, HelperRoles.RefereatObsad) | 
                                        @Html.AuthLink("Profil sędziego", "Details", "Referee", new { @Id = conflict.RefereeId }, new { }, HelperRoles.Sedzia)
                                    </div>
                                </div>
                                <div class="clear"></div>
                                @conflict.Period
                            </li>
                            <li class="divider"><span></span></li>
                        }
                    </ul>
            </div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script type="text/javascript">
    $("#addItem").click(function () {
        $.ajax({
            url: this.href,
            cache: false,
            success: function (html) { $("#NotePosition").before(html); }
        });
        return false;
    });

    $("a.deleteRow").live("click", function () {
        $(this).parents("div.formRow:first").remove();
        return false;
    });
</script>
